<h1 align=center>Test 2</h1>

<?php 

    $button='';

    if(isset($_POST['button'])) {

        $button = $_POST ['button'];
    
    }

    $file='';

    if(isset($_POST['file'])) {

        $file = $_POST ['file'];
  
    }

    if(!empty($file)){

      $input = file_get_contents($file);

    } else {
    }

?>

<head>

<meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

</head>

<form method='POST' class="container">

    <input type='file' name='file' class="btn btn-secondary" />

    <br>

    <input type='submit' name='button' class="btn btn-secondary" />

    <br>

</form>

<?php 
if(!empty($file)){
?>
  <div class = "container">

  <?php echo "<hr>"; ?>

  </div>
<?php
} else {

}
?>

<div class="container"> 

<table class="table table-striped">

<?php

    if(!empty($input)) {
        $arr = explode("\n", $input);

        $rows = 0;

        $age = 0;      
        
        $grade = 0;
        
        foreach($arr as $line) {

            $rows = $rows+1;                

            echo "<tr>";

            if($rows != 1){

                $real_row_number = $rows -1;
                echo "<td>$real_row_number</td>";

            } else {
                
                echo "<td>#</td>";  

            }

                $col = 0;

            $item = explode(",", $line);

            foreach($item as $each) {
        
                $col = $col+1;

            if($col == 2){

                $age = $age+(int)$each;

            }

            if($col == 5){

                $grade = $grade+(int)$each;

            }

                echo "<td>$each</td>";

            }

            echo "</tr>";

        }

    }

?>

</table>

</div>

<?php 
if(!empty($file)){
?>
  <div class = "container">
    
  <div class = "row">

  <div class = "col-sm-4">

<?php 

  echo "<hr>";

  $age = $age / $real_row_number;

  echo "The average age is $age";

?>

</div>

<div class = "col-sm-4">

<?php

  echo "<hr>";

  $grade = $grade / $real_row_number;

  echo "The average grade is $grade";

?>

</div>

<div class = "col-sm-4">

<?php

  echo "<hr>";

  echo "Number of inputs for this form: $real_row_number";

?>

</div>

</div>

</div>

<?php

} else {
}
?>
