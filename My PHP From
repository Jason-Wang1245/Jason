<?php

    
$button='';

if(isset($_POST['button'])) {

    $button = $_POST ['button'];
    
}

$file='';

if(isset($_POST['file'])) {

  $file = $_POST ['file'];
  
}

  $input = file_get_contents($file);

?>

<form method='POST'>

<input type='file' name='file' />

<br>

<input type='submit' name='button' />

<br>

<textarea name="input" cols="50" rows="11" id="comment" readonly="enabled">
  <?php echo $input ?>
</textarea>

</form>

<?php

    if(!empty($input)) {
        $arr = explode("\n", $input);

        $rows = 0;

        $age = 0;      
        
        $grade = 0;
        
        foreach($arr as $line) {

            $rows = $rows+1;                

            echo "<tr>";

            if($rows != 1){

                $real_row_number = $rows -1;
                echo "<td>$real_row_number</td>";

            } else {
                
                echo "<td>#</td>";  

            }

                $col = 0;

            $item = explode(",", $line);

            foreach($item as $each) {
        
                $col = $col+1;

            if($col == 2){

                $age = $age+(int)$each;

            }

            if($col == 5){

                $grade = $grade+(int)$each;

            }

                echo "<td>$each</td>";

            }

            echo "</tr>";

        }

    }

?>

</table>

</div>

<div class = "container">
    
    <div class = "row">

    <div class = "col-sm-4">

<?php 

    echo "<hr>";

    $age = $age / $real_row_number;

    echo "The average age is $age";

?>

</div>

<div class = "col-sm-4">

<?php

    echo "<hr>";

    $grade = $grade / $real_row_number;

    echo "The average grade is $grade";

?>

</div>

<div class = "col-sm-4">

<?php

    echo "<hr>";

    echo "Number of inputs for this form: $real_row_number";

?>

</div>

</div>

</div>
